# Using Conda

# Create Prefect Environment
conda create -n zoomcamp python=3.9
conda activate {insert prefect environment}

# PIP loading requirements from txt files
pip install -r requirements.txt

# Launching Orion UI 
prefect orion start



# Python import prefect libraries
from prefect import flow, task
from prefect_gcp.cloud_storage import GcsBucket

# Python flow, taks decorators
@flow(retries=3) #If a raise occurs, retry the flow
@task(log_prints=True) # If a print is done, stores in log


# Create a bucket in google cloud storage
# Insert bucket module into python
prefect block register -m prefect_gcp

# In orion, go to block and get the gcs bucket block
# The name of the bucket should be the name of the bucket from gcp
# Create GCP credentials to give service account into the block
IAM Admin -> Service Account -> Create service account
Permissions: BigQuery Admin, Storage Admin
Create Key -> insert key into bucket block in prefect


# Sending a file from path to GCS bucket python implementation
# More information in prefect documentation
gcs_block = GcsBucket.load("zoom-gcs") # Name of bucket in gcs
gcs_block.upload_from_path(from_path=f"{path}", to_path= path)

